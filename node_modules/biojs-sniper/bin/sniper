#!/usr/bin/env node

var program = require('commander');
var path = require('path');
var fs = require('fs');
var join = path.join;
var basename = path.basename;
var cwd = process.cwd();
var Server = require("../index.js");

program
  .version(JSON.parse(fs.readFileSync(__dirname + '/../package.json', 'utf8')).version)
  .usage('[options] [files]')
  .option('-p, --port <number>', 'port to run', 9090)
  .parse(process.argv);


// default settings
var options = {
	config: "package.json",
	templateDir: "templates",
	snippets: "snippets",
}

// PARSE cli

if(program.args.length == 0){
	options.dirname = cwd;
} else {
	options.dirname = program.args[0];	
}

options.port = program.port;
options.dirname = path.normalize(options.dirname);

console.log("running: http://localhost:" + options.port);
console.log("DIR:" + options.dirname);

var server = Server(options);
